<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title><%= reports[0]?.pageTitle || "診断結果｜概要" %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/report.css" />
</head>
<body class="print-a4">
  <% const generatedAtLabel = reports[0]?.generatedAtLabel || ""; %>
  <style>
    @page {
      size: A4;
      margin: 0 0 7.5mm 0; /* さらに1mm増やす */
      @bottom-center {
        content: counter(page) " / " counter(pages);
        font-size: 8pt;
        color: var(--ink-900);
        margin-bottom: 2.0mm;
      }
      @bottom-right {
        content: "<%= generatedAtLabel %>";
        font-size: 8pt;
        color: var(--ink-900);
        margin-bottom: 2.0mm;
        padding-right: 10mm;
      }
    }
  </style>
  <% reports.forEach(report => { %>
    <% const detailPages = report.detailPages || []; %>
    <% const guidancePageNumber = report.guidancePageNumber || (detailPages.length ? detailPages[detailPages.length - 1].pageNumber + 1 : 2); %>
    <main class="sheet" id="<%= report.driverId %>-page-1 %>">
      <%- include('../partials/header/header_gaiyou', { report: report }) %>
      <div class="report-bodyWrap">
        <%- include('../partials/body/body_gaiyou', { report: report }) %>
      </div>
    </main>
    <% detailPages.forEach(function(pageEntry) { %>
      <main class="sheet sheet--break" id="<%= report.driverId %>-page-<%= pageEntry.pageNumber %>">
        <%- include('../partials/header/header_detail', { report: report, section: pageEntry.section, pageIndex: pageEntry.index, totalPages: pageEntry.totalPages }) %>
        <div class="report-bodyWrap">
          <%- include('../partials/body/body_detail', { report: report, section: pageEntry.section, page: pageEntry.page, pageIndex: pageEntry.index, totalPages: pageEntry.totalPages }) %>
        </div>
      </main>
    <% }) %>

  <% }) %>
</body>
</html>
